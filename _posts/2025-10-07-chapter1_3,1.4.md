---
title: "Reverse Engineering for Beginners (CH1.3,CH1.4 Empty Function & Returning Values)"
date: 2025-10-11 00:00:00 +0800
categories: [Reverse, Books]
tags: [Reverse, Books]
image: "assets/img/reverse3.jpg"
---

<div style="line-height:1.9; font-size:21px; direction:ltr;">

<h1 style="color:#9a3ba6;"><b>An Empty Function</b></h1>
<img src="/assets/img/EmptyFunction.png" alt="EmptyFunction" style="display:block; margin:20px auto; border-radius:12px; max-width:60%;">

<hr>

<p>
At that time, the author said that the simplest function that can be written is the <b>Empty Function</b>.
</p>

<p>
Let‚Äôs see how it turns into Assembly.
</p>

<p>Here‚Äôs the code:</p>
<!-- üß† Code Block Component -->
<div class="code-box" data-lang="C/C++" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">C/C++</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
void f() {
    return;
}
</code>
  </pre>
</div>

<p>Now, let‚Äôs compile it for:</p>

<h2 style="color:#3ba2a6;"><b>1 - X86</b></h2>

<p>And here‚Äôs what we got:</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="Assembly" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">Assembly</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
f:
    ret
</code>
  </pre>
</div>


<p>
So it returned only one instruction, which is <code>ret</code>,  
and that means the code returns to execute what comes after the function that called it.
</p>

<h2 style="color:#3ba2a6;"><b>2 - ARM</b></h2>

<p>And here‚Äôs what we got:</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="language-nasm" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">nasm</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
f
    PROC
    BX      lr
    ENDP
</code>
  </pre>
</div>


<p>
If you notice, in ARM, the address that we should return to is not stored in the stack like in x86,  
but instead it is stored inside a register called <b>Link Register (lr)</b>.
</p>

<p>
Let me explain it to you in a simpler way and go through it step by step.
</p>

<p>
In <b>x86</b>, when you make a call to a function,  
the processor puts the return address in the <b>stack</b>.
</p>

<p>
When the function finishes and executes <code>ret</code>,  
the processor takes that address from the stack and returns to it.
</p>

<p>
In <b>ARM</b>, the method is a bit different.  
ARM has a place where it stores the return address called the <b>Link Register (lr)</b>.
</p>

<p>
That‚Äôs where <b>the address that the function should return to after finishing</b> is saved.
</p>

<p>
So instead of putting it in the stack, it stores it inside <b>LR</b>.
</p>

<p>
Now what is this <b>BX</b> that we wrote, and we say it jumps back to what‚Äôs inside LR?
</p>

<p>
Simply, <b>BX</b> means ‚Äú<i>Branch and eXchange</i>‚Äù.
</p>

<p>
And this instruction tells the processor:
</p>

<blockquote style="background:#2b2b2b; color:#ddd; padding:10px 14px; border-left:4px solid #9a3ba6; border-radius:6px;">
"Jump to the address stored in this register (here LR)"<br><br>
And it can also switch between ARM or Thumb mode (that‚Äôs something specific to ARM architecture).<br><br>
But here we‚Äôre using it just to ‚Äúreturn‚Äù, not to switch modes.
</blockquote>

<h2 style="color:#3ba2a6;"><b>3 - MIPS</b></h2>

<p>
In the <b>MIPS</b> architecture, there are two ways to write register names:
</p>

<ul>
  <li>Either by numbers (from <code>$0</code> to <code>$31</code>),</li>
  <li>Or by symbolic names (like <code>$v0</code>, <code>$a0</code>, etc.)</li>
</ul>

<p>
The GCC compiler outputs the code like this:
</p>
<!-- üß† Code Block Component -->
<div class="code-box" data-lang="language-nasm" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">nasm</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
j   $31
nop
</code>
  </pre>
</div>


<p>
But the IDA program writes it with symbolic names like this:
</p>
<!-- üß† Code Block Component -->
<div class="code-box" data-lang="language-nasm" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">nasm</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
j  ra
nop
</code>
  </pre>
</div>


<p>
The first instruction <code>j $ra</code> means jump to the address stored in <code>$ra</code> ‚Äî  
and that‚Äôs the same idea as ‚Äúreturning‚Äù to the function that called you.
</p>

<p>
The register <code>$ra</code> is the same concept as the <b>LR</b> register in ARM.
</p>

<p>
As for the second instruction <code>nop</code>, it‚Äôs short for <b>No Operation</b>,  
which means ‚Äúdo nothing‚Äù ‚Äî it‚Äôs sometimes written for alignment or ordering inside the processor.
</p>
<hr>


<h1 style="color:#9a3ba6;"><b>Returning Values</b></h1>
<img src="/assets/img/ReturningValues.jpeg" alt="ReturningValues" style="display:block; margin:20px auto; border-radius:12px; max-width:60%;">

<hr>

<p>
The author also said that there‚Äôs another type of function that basically just returns a constant number, like this one:
</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="C/C++" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">C/C++</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
int f()
{
    return 123;
}
</code>
  </pre>
</div>

<p>Let‚Äôs take a look at it.</p>

<h2 style="color:#3ba2a6;"><b>1 - x86</b></h2>

<p>
When compiled (whether by GCC or MSVC) with optimization enabled on an <b>x86</b> architecture, the compiler produces this code:
</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="Assembly" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">Assembly</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
f:
    mov eax, 123
    ret
</code>
  </pre>
</div>

<p>
This code does two things:
</p>

<ul>
  <li>First, it moves the value <code>123</code> into the <b>EAX</b> register ‚Äî and by the way, that‚Äôs the register the processor always uses to store the return value of a function.</li>
  <li>Second, the <code>ret</code> instruction means ‚Äúreturn to the place where this function was called.‚Äù</li>
</ul>

<hr>

<h2 style="color:#3ba2a6;"><b>2 - ARM</b></h2>

<p>
Here things are a bit different, and it looks like this:
</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="Assembly" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">Assembly</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
f PROC
    MOV r0, #0x7B ; 123
    BX lr
ENDP
</code>
  </pre>
</div>

<p>
In short, the ARM architecture uses the <b>R0</b> register to hold the return value of a function.  
That‚Äôs why the number 123 is copied into <b>R0</b>.
</p>

<p>
By the way, the instruction <b>MOV</b> doesn‚Äôt actually move the value ‚Äî it just makes a copy of it and places it there.
</p>

<hr>

<h2 style="color:#3ba2a6;"><b>3 - MIPS</b></h2>

<p>
In this case, the author said that when compiled with GCC, the code looks like this:
</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="Assembly" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">Assembly</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
j $31
li $2,123 # 0x7B
</code>
  </pre>
</div>

<p>
And in IDA, it shows like this:
</p>

<!-- üß† Code Block Component -->
<div class="code-box" data-lang="Assembly" style="border:1px solid #30363d;border-radius:8px;overflow:hidden;background:#0d1117;font-family:Consolas, monospace;">

  <!-- Header -->
  <div style="background:#161b22;display:flex;align-items:center;justify-content:space-between;padding:0.6rem 1rem;">
    <div style="display:flex;gap:6px;">
      <span style="width:12px;height:12px;border-radius:50%;background:#ff5f56;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#ffbd2e;"></span>
      <span style="width:12px;height:12px;border-radius:50%;background:#27c93f;"></span>
    </div>
    <span style="font-size:0.9rem;color:#8b949e;">Assembly</span>
    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.innerText);this.innerText='Copied!';setTimeout(()=>this.innerText='Copy',2000);" style="background:#21262d;border:1px solid #30363d;color:#8b949e;font-size:0.8rem;padding:3px 8px;border-radius:6px;cursor:pointer;">Copy</button>
  </div>

  <!-- Code -->
  <pre style="margin:0;padding:1rem;font-size:15px;line-height:1.6;overflow-x:auto;color:#c9d1d9;">
<code>
jr $ra
li $v0, 0x7B
</code>
  </pre>
</div>

<p>
The register <b>$2</b> (also known as <b>$v0</b>) is the one that stores the value returned by the function.
</p>

<p>
The instruction <b>LI</b> stands for ‚ÄúLoad Immediate‚Äù, which means it loads that number directly into the register ‚Äî the same concept as <b>MOV</b>.
</p>

<p>
Now, the question is ‚Äî why do we jump to <code>$31</code> <i>first</i> and then load the number, when logically it should be the other way around?
</p>

<p>
Well, the author explained that this happens because of something in the <b>RISC</b> architecture called the <b>‚Äúbranch delay slot‚Äù</b>.
</p>

<p>
Simply put, this means the instruction that comes <b>after</b> a branch (or jump) gets executed <b>before</b> the jump itself.
</p>

<p>
So the compiler swaps their order ‚Äî it‚Äôs not a big deal for now, but keep it in mind.
</p>

<p>
And just as an example, in UNIX you have:
</p>

<ul>
  <li><code>/bin/true</code> ‚Üí returns 0</li>
  <li><code>/bin/false</code> ‚Üí returns 1</li>
</ul>

<p>
That‚Äôs because in UNIX, <b>0</b> means ‚Äúeverything is fine‚Äù,  
and any other number means ‚Äúan error occurred‚Äù.
</p>

<hr>
















</div>


